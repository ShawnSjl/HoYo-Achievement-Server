databaseChangeLog:
  - changeSet:
      id: create_server_info
      author: ShawnSjl
      context: "dev, prod"
      preConditions:
        - onFail: MARK_RAN
        - not:
            tableExists:
              tableName: server_info
      changes:
        - createTable:
            tableName: server_info
            remarks: 服务器信息表
            columns:
              - column: { name: info_id, type: BIGINT UNSIGNED AUTO_INCREMENT, constraints: { primaryKey: true } }
              - column: { name: server_version, type: VARCHAR(24), constraints: { nullable: false} }
              - column: { name: zzz_version, type: VARCHAR(24), constraints: { nullable: false } }
              - column: { name: sr_version, type: VARCHAR(24), constraints: { nullable: false } }
              - column: { name: update_description, type: VARCHAR(1024), constraints: { nullable: false } }
              - column: { name: updated_at, type: DATETIME, defaultValueComputed: CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP }
      rollback:
        - dropTable: { tableName: server_info }

  - changeSet:
      id: create_data_migration
      author: ShawnSjl
      context: "dev, prod"
      preConditions:
        - onFail: MARK_RAN
        - not:
            tableExists:
              tableName: data_migration
      changes:
        - createTable:
            tableName: data_migration
            remarks: 数据加载表
            columns:
              - column: { name: id, type: BIGINT UNSIGNED AUTO_INCREMENT, constraints: { primaryKey: true } }
              - column: { name: name, type: VARCHAR(128), constraints: { nullable: false, unique: true } }
              - column: { name: path, type: VARCHAR(1024), constraints: { nullable: false } }
              - column: { name: type, type: VARCHAR(16), constraints: { nullable: false } }
              - column: { name: depends, type: TEXT }
              - column: { name: migration_time, type: DATETIME, defaultValueComputed: CURRENT_TIMESTAMP ON UPDATE 
                CURRENT_TIMESTAMP }
      rollback:
        - dropTable: { tableName: data_migration }
